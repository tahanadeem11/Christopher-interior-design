<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Christopher Poole | Architectural Interior Design</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Cormorant:wght@300;600&family=Josefin+Sans:wght@300&display=swap"
      rel="stylesheet"
    />

    <style>
      :root {
        --primary-text: #574f4d;
        --secondary-text: #d5d5c8;
        --cursor-color: #d5d5c8;
        --menu-bg: rgba(213, 213, 200, 0.95);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Josefin Sans", sans-serif;
        font-weight: 300;
        color: var(--primary-text);
        background-color: #3a4d42; /* Green slate background */
        overflow-x: hidden;
        cursor: none;
      }

      /* Custom Cursor */
      .cursor {
        width: 30px;
        height: 30px;
        border: 1px solid var(--cursor-color);
        border-radius: 50%;
        position: fixed;
        transform: translate(-50%, -50%);
        pointer-events: none;
        z-index: 9999;
        transition: all 0.1s ease;
        opacity: 0.7;
      }

      .cursor.hover {
        background-color: rgba(213, 213, 200, 0.3);
        transform: translate(-50%, -50%) scale(1.5);
      }

      /* Horizontal Scrolling Container */
      .container {
        display: flex;
        flex-direction: row;
        width: auto; /* Dynamic width - will be set by JavaScript */
        height: 100vh;
        transition: transform 0.8s ease;
      }

      .section {
        width: 100vw; /* Default width - will be overridden by JavaScript */
        min-width: 100vw; /* Minimum width constraint */
        height: 100vh;
        position: relative;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        padding: 0 5%;
        flex-shrink: 0; /* Prevent sections from shrinking */
      }

      /* Logo */
      .logo {
        position: fixed;
        top: 30px;
        left: 30px;
        z-index: 100;
        background-color: transparent;
      }

      .logo h1 {
        font-family: "Cormorant", serif;
        font-weight: 600;
        font-size: 18pt;
        color: var(--secondary-text);
        letter-spacing: 1px;
      }

      .logo h2 {
        font-family: "Josefin Sans", sans-serif;
        font-weight: 300;
        font-size: 10pt;
        color: var(--secondary-text);
        letter-spacing: 2px;
        margin-top: 5px;
      }

      /* Menu */
      .menu-toggle {
        position: fixed;
        top: 30px;
        right: 30px;
        z-index: 100;
        cursor: none;
        color: var(--secondary-text);
        font-family: "Josefin Sans", sans-serif;
        font-weight: 300;
        font-size: 13pt;
        letter-spacing: 2px;
        text-transform: uppercase;
      }

      .menu {
        position: fixed;
        top: 0;
        right: -300px;
        width: 300px;
        height: 100vh;
        background-color: var(--menu-bg);
        padding: 100px 30px;
        transition: right 0.5s ease;
        z-index: 99;
        display: flex;
        flex-direction: column;
        justify-content: center;
      }

      .menu.active {
        right: 0;
      }

      .menu-item {
        margin-bottom: 30px;
        font-family: "Josefin Sans", sans-serif;
        font-weight: 300;
        font-size: 14pt;
        color: var(--primary-text);
        text-transform: uppercase;
        letter-spacing: 1px;
        cursor: none;
        transition: color 0.3s ease;
      }

      .menu-item:hover {
        color: var(--primary-text);
      }

      .menu-line {
        width: 100%;
        height: 1px;
        background-color: rgba(255, 255, 255, 0.4);
        margin: 10px 0;
      }

      /* Home Section */
      .home {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }

      .video-container {
        width: 100%;
        height: 60vh;
        position: relative;
        overflow: hidden;
      }

      .video-placeholder {
        width: 100%;
        height: 100%;
        background-color: #2a3d32;
        display: flex;
        justify-content: center;
        align-items: center;
        color: var(--secondary-text);
        font-family: "Josefin Sans", sans-serif;
        font-size: 16pt;
      }

      .testimonials {
        width: 80%;
        margin-top: 50px;
        height: 100px;
        position: relative;
      }

      .testimonial {
        position: absolute;
        width: 100%;
        text-align: center;
        font-family: "Josefin Sans", sans-serif;
        font-size: 14pt;
        color: var(--secondary-text);
        opacity: 0;
        transition: opacity 2s ease;
      }

      .testimonial.active {
        opacity: 1;
      }

      .audio-control {
        position: absolute;
        bottom: 30px;
        right: 30px;
        background-color: transparent;
        border: 1px solid var(--secondary-text);
        color: var(--secondary-text);
        padding: 8px 15px;
        font-family: "Josefin Sans", sans-serif;
        font-size: 12pt;
        cursor: none;
        transition: all 0.3s ease;
      }

      .audio-control:hover {
        background-color: rgba(213, 213, 200, 0.2);
      }

      /* Ethos Section */
      .ethos {
        flex-direction: column;
      }

      .ethos-title {
        font-family: "Cormorant", serif;
        font-weight: 600;
        font-size: 24pt;
        color: var(--secondary-text);
        margin-bottom: 50px;
        text-align: center;
      }

      .ethos-description {
        font-family: "Josefin Sans", sans-serif;
        font-size: 14pt;
        color: var(--secondary-text);
        max-width: 600px;
        text-align: center;
        margin-bottom: 60px;
      }

      .values-container {
        display: flex;
        justify-content: space-between;
        width: 80%;
        margin-top: 30px;
      }

      .value {
        width: 30%;
        text-align: center;
      }

      .value h3 {
        font-family: "Cormorant", serif;
        font-weight: 600;
        font-size: 18pt;
        color: var(--secondary-text);
        margin-bottom: 20px;
      }

      .value p {
        font-family: "Josefin Sans", sans-serif;
        font-size: 12pt;
        color: var(--secondary-text);
        line-height: 1.6;
      }

      /* Story Section */
      .story {
        flex-direction: column;
        align-items: stretch; /* stretch children to full width */
        justify-content: center; /* vertical middle */
        padding-top: 0;
        padding-left: 0; /* remove section's 5% left padding */
        padding-right: 0; /* remove section's 5% right padding */
        overflow: hidden; /* keep overflow inside inner scroller */
      }

      .story-title {
        font-family: "Cormorant", serif;
        font-weight: 600;
        font-size: 24pt;
        color: var(--secondary-text);
        margin-bottom: 30px;
        width: 100%;
        text-align: center;
      }

      .story-content {
        overflow-x: auto;
        overflow-y: hidden;
        display: flex;
        flex-direction: row;
        gap: 40px;
        width: 100%;
        height: calc(100vh - 200px); /* account for title and spacing */
        align-items: flex-start;
        padding-left: 0;
        padding-right: 0;
        overscroll-behavior-x: contain; /* prevent scroll chaining to parent */
        -webkit-overflow-scrolling: touch; /* smooth iOS scrolling */
        scrollbar-width: thin;
        scrollbar-color: var(--secondary-text) transparent;
        flex-wrap: nowrap; /* prevent wrapping */
      }

      .story-content::-webkit-scrollbar {
        height: 6px;
      }

      .story-content::-webkit-scrollbar-track {
        background: transparent;
      }

      .story-content::-webkit-scrollbar-thumb {
        background-color: var(--secondary-text);
        border-radius: 3px;
      }

      .story-paragraph {
        font-family: "Josefin Sans", sans-serif;
        font-size: 12pt;
        color: var(--secondary-text);
        line-height: 1.8;
        min-width: 300px;
        max-width: 400px;
        flex-shrink: 0;
      }

      .story-image {
        width: 350px;
        height: 300px;
        background-color: #2a3d32;
        margin: 20px 0;
        flex-shrink: 0;
      }

      .highlight-box {
        background-color: rgba(87, 79, 77, 0.2);
        padding: 20px;
        border-left: 3px solid var(--secondary-text);
        margin: 20px 0;
      }

      /* Future Projects Section */
      .future-projects {
        flex-direction: column;
      }

      .projects-title {
        font-family: "Cormorant", serif;
        font-weight: 600;
        font-size: 24pt;
        color: var(--secondary-text);
        margin-bottom: 50px;
        text-align: center;
      }

      .projects-container {
        display: flex;
        justify-content: space-between;
        width: 90%;
        margin-top: 30px;
      }

      .project {
        width: 30%;
        height: 400px;
        position: relative;
        overflow: hidden;
      }

      .project-image {
        width: 100%;
        height: 100%;
        background-color: #2a3d32;
        transition: all 0.5s ease;
      }

      .project-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(87, 79, 77, 0.7);
        display: flex;
        justify-content: center;
        align-items: center;
        opacity: 0;
        transition: opacity 0.5s ease;
      }

      .project:hover .project-overlay {
        opacity: 1;
      }

      .project-title {
        font-family: "Cormorant", serif;
        font-weight: 600;
        font-size: 18pt;
        color: var(--secondary-text);
        text-align: center;
      }

      /* Quarry Section */
      .quarry {
        flex-direction: column;
      }

      .quarry-title {
        font-family: "Cormorant", serif;
        font-weight: 600;
        font-size: 24pt;
        color: var(--secondary-text);
        margin-bottom: 50px;
        text-align: center;
      }

      .quarry-content {
        width: 80%;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .quarry-images {
        display: flex;
        justify-content: space-between;
        width: 100%;
        margin: 30px 0;
      }

      .quarry-image {
        width: 48%;
        height: 300px;
        background-color: #2a3d32;
      }

      .quarry-description {
        font-family: "Josefin Sans", sans-serif;
        font-size: 12pt;
        color: var(--secondary-text);
        line-height: 1.8;
        margin: 30px 0;
        text-align: center;
      }

      /* Contact Section */
      .contact {
        flex-direction: column;
      }

      .contact-title {
        font-family: "Cormorant", serif;
        font-weight: 600;
        font-size: 24pt;
        color: var(--secondary-text);
        margin-bottom: 50px;
        text-align: center;
      }

      .contact-form {
        width: 60%;
        background-color: rgba(255, 255, 255, 0.1);
        padding: 40px;
        border-radius: 5px;
      }

      .form-group {
        margin-bottom: 25px;
      }

      .form-group label {
        display: block;
        font-family: "Josefin Sans", sans-serif;
        font-size: 12pt;
        color: var(--secondary-text);
        margin-bottom: 8px;
      }

      .form-group input,
      .form-group textarea {
        width: 100%;
        padding: 12px;
        background-color: rgba(255, 255, 255, 0.1);
        border: 1px solid var(--secondary-text);
        color: var(--secondary-text);
        font-family: "Josefin Sans", sans-serif;
        font-size: 12pt;
        border-radius: 3px;
      }

      .form-group textarea {
        height: 150px;
        resize: none;
      }

      .submit-btn {
        background-color: transparent;
        border: 1px solid var(--secondary-text);
        color: var(--secondary-text);
        padding: 12px 30px;
        font-family: "Josefin Sans", sans-serif;
        font-size: 14pt;
        cursor: none;
        transition: all 0.3s ease;
      }

      .submit-btn:hover {
        background-color: rgba(213, 213, 200, 0.2);
      }

      .contact-info {
        margin-top: 40px;
        text-align: center;
        font-family: "Josefin Sans", sans-serif;
        font-size: 14pt;
        color: var(--secondary-text);
      }

      .social-links {
        margin-top: 20px;
        display: flex;
        justify-content: center;
        gap: 20px;
      }

      .social-link {
        color: var(--secondary-text);
        font-family: "Josefin Sans", sans-serif;
        font-size: 12pt;
        text-decoration: none;
        transition: color 0.3s ease;
      }

      .social-link:hover {
        color: var(--primary-text);
      }

      /* Back Button */
      .back-button {
        position: absolute;
        bottom: 30px;
        left: 30px;
        background-color: transparent;
        border: 1px solid var(--secondary-text);
        color: var(--secondary-text);
        padding: 8px 15px;
        font-family: "Josefin Sans", sans-serif;
        font-size: 12pt;
        cursor: none;
        transition: all 0.3s ease;
      }

      .back-button:hover {
        background-color: rgba(213, 213, 200, 0.2);
      }

      /* Navigation Dots */
      .nav-dots {
        position: fixed;
        bottom: 30px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 15px;
        z-index: 100;
      }

      .nav-dot {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background-color: rgba(213, 213, 200, 0.3);
        cursor: none;
        transition: all 0.3s ease;
      }

      .nav-dot.active {
        background-color: var(--secondary-text);
      }
    </style>
  </head>
  <body>
    <!-- Custom Cursor -->
    <div class="cursor"></div>

    <!-- Logo -->
    <div class="logo">
      <h1>CHRISTOPHER POOLE</h1>
      <h2>ARCHITECTURAL INTERIOR DESIGN</h2>
    </div>

    <!-- Menu Toggle -->
    <div class="menu-toggle">MENU</div>

    <!-- Menu -->
    <div class="menu">
      <div class="menu-item" data-section="0">HOME</div>
      <div class="menu-line"></div>
      <div class="menu-item" data-section="1">ETHOS</div>
      <div class="menu-line"></div>
      <div class="menu-item" data-section="2">STORY</div>
      <div class="menu-line"></div>
      <div class="menu-item" data-section="3">FUTURE PROJECTS</div>
      <div class="menu-line"></div>
      <div class="menu-item" data-section="4">THE QUARRY</div>
      <div class="menu-line"></div>
      <div class="menu-item" data-section="5">CONTACT</div>
    </div>

    <!-- Main Container -->
    <div class="container">
      <!-- Home Section -->
      <section class="section home">
        <div class="video-container">
          <div class="video-placeholder">Leaf Video</div>
        </div>
        <div class="testimonials">
          <div class="testimonial active">
            "He designed around how we live... we just feel so much more connected as a family now."
          </div>
          <div class="testimonial">
            "The space feels like it was always meant to be this way. Natural, calm, and perfectly balanced."
          </div>
          <div class="testimonial">
            "Working with Christopher transformed not just our home, but how we experience it every day."
          </div>
          <div class="testimonial">
            "There's a sense of peace in our home now that we never had before. It's truly remarkable."
          </div>
          <div class="testimonial">
            "Every detail feels intentional. Every space feels connected. It's more than design, it's feeling."
          </div>
        </div>
        <button class="audio-control">AUDIO OFF</button>
      </section>

      <!-- Ethos Section -->
      <section class="section ethos">
        <h2 class="ethos-title">THE ETHOS</h2>
        <p class="ethos-description">
          The stone sink rests on a reclaimed timber surface, its raw form echoing in imperfection. A steel-framed
          mirror adds structure, while the lighting — placed at face level — was carefully considered to avoid harsh
          overhead shadows.
        </p>
        <p class="ethos-description">Our work is guided by feeling.</p>

        <div class="values-container">
          <div class="value">
            <h3>Peace</h3>
            <p>The design should ground you. Light, air, and materials that calm the nervous system.</p>
          </div>
          <div class="value">
            <h3>Simplicity</h3>
            <p>Nothing extra. Everything necessary. Beauty found in restraint.</p>
          </div>
          <div class="value">
            <h3>Flow</h3>
            <p>From one room to the next, one breath to the next—our work moves like water.</p>
          </div>
        </div>
      </section>

      <!-- Story Section -->
      <section class="section story">
        <h2 class="story-title">OUR STORY</h2>
        <div class="story-content">
          <p class="story-paragraph">
            Design should hold you, not overwhelm you. My approach to design isn't rooted in trends. It's rooted in
            experience, intuition, and an ongoing relationship with stillness, light, and nature.
          </p>

          <div class="story-image"></div>

          <p class="story-paragraph">
            Everything I create begins with one question: How should this space make you feel? That feeling guides every
            decision.
          </p>

          <p class="story-paragraph">
            My journey began with a fascination for how spaces influence our emotions and interactions. I studied
            traditional techniques not to replicate them, but to understand their underlying principles—how they create
            harmony, balance, and a sense of belonging.
          </p>

          <div class="story-image"></div>

          <p class="story-paragraph">
            Today, my work continues to be guided by these principles. Each project is a conversation between the
            existing environment, the needs of its inhabitants, and the possibilities that emerge when we listen deeply
            to both.
          </p>
        </div>
        <button class="back-button">BACK</button>
      </section>

      <!-- Future Projects Section -->
      <section class="section future-projects">
        <h2 class="projects-title">FUTURE PROJECTS</h2>
        <div class="projects-container">
          <div class="project">
            <div class="project-image"></div>
            <div class="project-overlay">
              <h3 class="project-title">FOREST RETREAT</h3>
            </div>
          </div>
          <div class="project">
            <div class="project-image"></div>
            <div class="project-overlay">
              <h3 class="project-title">COASTAL HAVEN</h3>
            </div>
          </div>
          <div class="project">
            <div class="project-image"></div>
            <div class="project-overlay">
              <h3 class="project-title">URBAN OASIS</h3>
            </div>
          </div>
        </div>
        <button class="back-button">BACK</button>
      </section>

      <!-- Quarry Section -->
      <section class="section quarry">
        <h2 class="quarry-title">THE QUARRY</h2>
        <div class="quarry-content">
          <p class="quarry-description">
            A transformation of industrial space into a harmonious living environment that respects its history while
            embracing modern comfort.
          </p>

          <div class="quarry-images">
            <div class="quarry-image"></div>
            <div class="quarry-image"></div>
          </div>

          <p class="quarry-description">
            This project challenged us to balance the raw, powerful character of the quarry with the need for warmth and
            livability. By carefully selecting materials that complement rather than compete with the existing stone,
            we've created spaces that feel both grounded and elevated.
          </p>

          <div class="highlight-box">
            <p class="story-paragraph">
              The most successful designs are those that honor the spirit of a place while making room for new life to
              unfold.
            </p>
          </div>
        </div>
        <button class="back-button">BACK</button>
      </section>

      <!-- Contact Section -->
      <section class="section contact">
        <h2 class="contact-title">GET IN TOUCH</h2>
        <form class="contact-form">
          <div class="form-group">
            <label for="name">NAME</label>
            <input type="text" id="name" name="name" />
          </div>
          <div class="form-group">
            <label for="email">EMAIL</label>
            <input type="email" id="email" name="email" />
          </div>
          <div class="form-group">
            <label for="message">MESSAGE</label>
            <textarea id="message" name="message"></textarea>
          </div>
          <button type="submit" class="submit-btn">SEND</button>
        </form>

        <div class="contact-info">
          <p>Please get in touch by completing the form or emailing: christopher@christopherpoole.design</p>
          <div class="social-links">
            <a href="#" class="social-link">INSTAGRAM</a>
            <a href="#" class="social-link">PINTEREST</a>
          </div>
        </div>
        <button class="back-button">BACK</button>
      </section>
    </div>

    <!-- Navigation Dots
    <div class="nav-dots">
      <div class="nav-dot active" data-section="0"></div>
      <div class="nav-dot" data-section="1"></div>
      <div class="nav-dot" data-section="2"></div>
      <div class="nav-dot" data-section="3"></div>
      <div class="nav-dot" data-section="4"></div>
      <div class="nav-dot" data-section="5"></div>
    </div> -->

    <script>
      // ===== DYNAMIC WIDTH CALCULATION SYSTEM =====

      // SectionWidthCalculator - Core width calculation system
      class SectionWidthCalculator {
        constructor() {
          this.sectionWidths = [];
          this.sectionPositions = [];
          this.totalWidth = 0;
          this.minWidth = window.innerWidth;
          this.cache = new Map();
        }

        calculateSectionWidth(sectionElement, minWidth = this.minWidth) {
          try {
            const sectionId = sectionElement.classList[1] || sectionElement.classList[0];

            // Check cache first
            const cacheKey = `${sectionId}-${window.innerWidth}`;
            if (this.cache.has(cacheKey)) {
              return this.cache.get(cacheKey);
            }

            let contentWidth = this.measureContentWidth(sectionElement);

            // keep story section fixed to viewport width; horizontal scroll lives inside .story-content
            if (sectionElement.classList.contains("story")) {
              contentWidth = minWidth;
            }

            // Apply minimum width constraint
            const finalWidth = Math.max(contentWidth, minWidth);

            // Cache the result
            this.cache.set(cacheKey, finalWidth);

            console.log(`Section ${sectionId}: content=${contentWidth}px, final=${finalWidth}px`);
            return finalWidth;
          } catch (error) {
            console.warn("Width calculation failed, using fallback:", error);
            return minWidth;
          }
        }

        measureContentWidth(sectionElement) {
          // Create a temporary clone to measure natural width
          const clone = sectionElement.cloneNode(true);
          clone.style.position = "absolute";
          clone.style.visibility = "hidden";
          clone.style.width = "auto";
          clone.style.height = "auto";
          clone.style.left = "-9999px";

          document.body.appendChild(clone);

          // Get the scroll width of content
          const contentWidth = Math.max(
            clone.scrollWidth,
            clone.offsetWidth,
            ...Array.from(clone.children).map((child) => child.scrollWidth || 0)
          );

          document.body.removeChild(clone);
          return contentWidth;
        }

        calculateStoryWidth(storySection) {
          const storyContent = storySection.querySelector(".story-content");
          if (!storyContent) return this.minWidth;

          // Create a temporary clone to measure the actual horizontal layout
          const tempSection = storySection.cloneNode(true);
          tempSection.style.position = "absolute";
          tempSection.style.visibility = "hidden";
          tempSection.style.left = "-9999px";
          tempSection.style.width = "auto";
          tempSection.style.height = "100vh";

          document.body.appendChild(tempSection);

          const tempContent = tempSection.querySelector(".story-content");
          if (!tempContent) {
            document.body.removeChild(tempSection);
            return this.minWidth;
          }

          // Force the horizontal layout and measure
          tempContent.style.display = "flex";
          tempContent.style.flexDirection = "row";
          tempContent.style.gap = "40px";
          tempContent.style.width = "auto";
          tempContent.style.whiteSpace = "nowrap";

          // Set specific widths for child elements to match CSS
          const tempChildren = Array.from(tempContent.children);
          tempChildren.forEach((child) => {
            if (child.classList.contains("story-paragraph")) {
              child.style.minWidth = "300px";
              child.style.maxWidth = "400px";
              child.style.flexShrink = "0";
              child.style.whiteSpace = "normal";
            } else if (child.classList.contains("story-image")) {
              child.style.width = "350px";
              child.style.flexShrink = "0";
            }
          });

          // Force layout calculation
          tempContent.offsetWidth;

          // Get the actual scroll width of the horizontal content
          const actualWidth = tempContent.scrollWidth;

          document.body.removeChild(tempSection);

          // Add section padding (5% on each side) and some extra buffer
          const sectionPadding = window.innerWidth * 0.1;
          const buffer = 100; // Extra buffer to prevent overflow

          const finalWidth = Math.max(actualWidth + sectionPadding + buffer, this.minWidth);

          console.log(`Story section calculated width: ${finalWidth}px (content: ${actualWidth}px)`);
          return finalWidth;
        }

        recalculateAll() {
          this.minWidth = window.innerWidth;
          this.cache.clear();
          const sections = document.querySelectorAll(".section");
          this.sectionWidths = [];
          this.sectionPositions = [0];

          sections.forEach((section, index) => {
            const width = this.calculateSectionWidth(section);
            this.sectionWidths[index] = width;

            if (index > 0) {
              this.sectionPositions[index] = this.sectionPositions[index - 1] + this.sectionWidths[index - 1];
            }
          });

          this.totalWidth =
            this.sectionPositions[this.sectionPositions.length - 1] + this.sectionWidths[this.sectionWidths.length - 1];

          console.log("Recalculated widths:", this.sectionWidths);
          console.log("Positions:", this.sectionPositions);
          console.log("Total width:", this.totalWidth);

          // story section uses inner scroll; no outer width validation needed

          return {
            widths: this.sectionWidths,
            positions: this.sectionPositions,
            totalWidth: this.totalWidth,
          };
        }

        getSectionWidth(index) {
          return this.sectionWidths[index] || this.minWidth;
        }

        getSectionPosition(index) {
          return this.sectionPositions[index] || 0;
        }
      }

      // ContainerManager - Manages container width and positioning
      class ContainerManager {
        constructor(containerElement) {
          this.container = containerElement;
          this.sections = document.querySelectorAll(".section");
        }

        updateContainerWidth(totalWidth) {
          this.container.style.width = `${totalWidth}px`;
        }

        updateSectionWidths(widths) {
          this.sections.forEach((section, index) => {
            if (widths[index]) {
              section.style.width = `${widths[index]}px`;
            }
          });
        }

        getScrollPosition(sectionIndex, positions) {
          return positions[sectionIndex] || 0;
        }
      }

      // NavigationController - Handles navigation with dynamic positioning
      class NavigationController {
        constructor(containerManager, widthCalculator) {
          this.containerManager = containerManager;
          this.widthCalculator = widthCalculator;
          this.currentSection = 0;
          this.isAnimating = false;
          this.sections = document.querySelectorAll(".section");
          this.menuItems = document.querySelectorAll(".menu-item");
          this.navDots = document.querySelectorAll(".nav-dot");
          this.backButtons = document.querySelectorAll(".back-button");
          this.menu = document.querySelector(".menu");
        }

        scrollToSection(sectionIndex, animated = true) {
          if (this.isAnimating || sectionIndex < 0 || sectionIndex >= this.sections.length) {
            return;
          }

          this.isAnimating = true;
          this.currentSection = sectionIndex;

          const scrollPosition = this.widthCalculator.getSectionPosition(sectionIndex);

          if (animated) {
            this.containerManager.container.style.transform = `translateX(-${scrollPosition}px)`;
          } else {
            this.containerManager.container.style.transition = "none";
            this.containerManager.container.style.transform = `translateX(-${scrollPosition}px)`;
            setTimeout(() => {
              this.containerManager.container.style.transition = "transform 0.8s ease";
            }, 50);
          }

          this.updateNavigationStates(sectionIndex);

          // when entering the story section, ensure inner scroll starts at the left
          const targetSection = this.sections[sectionIndex];
          if (targetSection && targetSection.classList.contains("story")) {
            const inner = targetSection.querySelector(".story-content");
            if (inner) {
              inner.scrollLeft = 0;
            }
          }

          // Reset animation flag after transition
          setTimeout(() => {
            this.isAnimating = false;
          }, 800);

          console.log(`Navigated to section ${sectionIndex} at position ${scrollPosition}px`);
        }

        updateNavigationStates(currentSection) {
          // Update menu items
          this.menuItems.forEach((item, index) => {
            if (index === currentSection) {
              item.style.fontWeight = "600";
            } else {
              item.style.fontWeight = "300";
            }
          });

          // Update navigation dots
          this.navDots.forEach((dot, index) => {
            if (index === currentSection) {
              dot.classList.add("active");
            } else {
              dot.classList.remove("active");
            }
          });

          // Close menu
          this.menu.classList.remove("active");
        }

        handleKeyboardNavigation(event) {
          if (event.key === "ArrowRight" && this.currentSection < this.sections.length - 1) {
            this.scrollToSection(this.currentSection + 1);
          } else if (event.key === "ArrowLeft" && this.currentSection > 0) {
            this.scrollToSection(this.currentSection - 1);
          }
        }

        handleTouchNavigation(startX, endX) {
          const threshold = 50;
          if (endX < startX - threshold && this.currentSection < this.sections.length - 1) {
            this.scrollToSection(this.currentSection + 1);
          } else if (endX > startX + threshold && this.currentSection > 0) {
            this.scrollToSection(this.currentSection - 1);
          }
        }
      }

      // ResponsiveHandler - Manages viewport changes and recalculations
      class ResponsiveHandler {
        constructor(widthCalculator, containerManager, navigationController) {
          this.widthCalculator = widthCalculator;
          this.containerManager = containerManager;
          this.navigationController = navigationController;
          this.resizeTimeout = null;
        }

        handleResize() {
          // Throttle resize events
          if (this.resizeTimeout) {
            clearTimeout(this.resizeTimeout);
          }

          this.resizeTimeout = setTimeout(() => {
            console.log("Viewport changed, recalculating...");
            this.recalculateAndUpdate();
          }, 250);
        }

        recalculateAndUpdate() {
          const data = this.widthCalculator.recalculateAll();
          this.containerManager.updateContainerWidth(data.totalWidth);
          this.containerManager.updateSectionWidths(data.widths);

          // Re-position to current section
          this.navigationController.scrollToSection(this.navigationController.currentSection, false);
        }
      }

      // ===== INITIALIZATION =====

      // Initialize the dynamic width system
      const widthCalculator = new SectionWidthCalculator();
      const container = document.querySelector(".container");
      const containerManager = new ContainerManager(container);
      const navigationController = new NavigationController(containerManager, widthCalculator);
      const responsiveHandler = new ResponsiveHandler(widthCalculator, containerManager, navigationController);

      // Initial calculation and setup
      function initializeDynamicScrolling() {
        console.log("Initializing dynamic scrolling system...");

        const data = widthCalculator.recalculateAll();
        containerManager.updateContainerWidth(data.totalWidth);
        containerManager.updateSectionWidths(data.widths);

        // Set initial position
        navigationController.scrollToSection(0, false);
      }

      // ===== EVENT LISTENERS =====

      // Custom cursor
      const cursor = document.querySelector(".cursor");
      let mouseX = 0;
      let mouseY = 0;

      document.addEventListener("mousemove", (e) => {
        mouseX = e.clientX;
        mouseY = e.clientY;
        cursor.style.left = mouseX + "px";
        cursor.style.top = mouseY + "px";
      });

      // Add hover effect to clickable elements
      const clickableElements = document.querySelectorAll("a, button, .menu-item, .nav-dot, .back-button");
      clickableElements.forEach((element) => {
        element.addEventListener("mouseenter", () => cursor.classList.add("hover"));
        element.addEventListener("mouseleave", () => cursor.classList.remove("hover"));
      });

      // Menu toggle
      const menuToggle = document.querySelector(".menu-toggle");
      const menu = document.querySelector(".menu");
      menuToggle.addEventListener("click", () => menu.classList.toggle("active"));

      // Navigation event listeners
      navigationController.menuItems.forEach((item, index) => {
        item.addEventListener("click", () => navigationController.scrollToSection(index));
      });

      navigationController.navDots.forEach((dot, index) => {
        dot.addEventListener("click", () => navigationController.scrollToSection(index));
      });

      navigationController.backButtons.forEach((button) => {
        button.addEventListener("click", () => navigationController.scrollToSection(0));
      });

      // Keyboard navigation
      document.addEventListener("keydown", (e) => navigationController.handleKeyboardNavigation(e));

      // Touch navigation
      let touchStartX = 0;
      let touchEndX = 0;
      let touchFromStory = false;

      document.addEventListener("touchstart", (e) => {
        touchStartX = e.changedTouches[0].screenX;
        touchFromStory = !!(e.target && e.target.closest && e.target.closest(".story .story-content"));
      });

      document.addEventListener("touchend", (e) => {
        touchEndX = e.changedTouches[0].screenX;
        if (touchFromStory) {
          touchFromStory = false;
          return; // let the inner story-content handle the swipe
        }
        navigationController.handleTouchNavigation(touchStartX, touchEndX);
      });

      // Responsive handling
      window.addEventListener("resize", () => responsiveHandler.handleResize());

      // Testimonial rotation
      const testimonials = document.querySelectorAll(".testimonial");
      let currentTestimonial = 0;

      function rotateTestimonials() {
        testimonials[currentTestimonial].classList.remove("active");
        currentTestimonial = (currentTestimonial + 1) % testimonials.length;
        testimonials[currentTestimonial].classList.add("active");
      }

      setInterval(rotateTestimonials, 5000);

      // Audio control
      const audioControl = document.querySelector(".audio-control");
      let audioPlaying = false;

      audioControl.addEventListener("click", () => {
        audioPlaying = !audioPlaying;
        audioControl.textContent = audioPlaying ? "AUDIO ON" : "AUDIO OFF";
      });

      // Form submission
      const contactForm = document.querySelector(".contact-form");
      contactForm.addEventListener("submit", (e) => {
        e.preventDefault();
        alert("Thank you for your message. We will get back to you soon.");
        contactForm.reset();
      });

      // ===== TESTING UTILITIES =====

      // Simple testing function for development
      function runBasicTests() {
        console.log("Running basic tests...");

        // Test 1: Width calculation
        const sections = document.querySelectorAll(".section");
        console.log(`Found ${sections.length} sections`);

        // // Test 2: Navigation functionality
        // setTimeout(() => {
        //   console.log("Testing navigation to section 2...");
        //   navigationController.scrollToSection(2);

        //   setTimeout(() => {
        //     console.log("Testing navigation back to home...");
        //     navigationController.scrollToSection(0);
        //   }, 2000);
        // }, 1000);

        // Test 3: Responsive behavior
        console.log("Current viewport width:", window.innerWidth);
        console.log("Section widths:", widthCalculator.sectionWidths);
        console.log("Section positions:", widthCalculator.sectionPositions);
        console.log("Total container width:", widthCalculator.totalWidth);
      }

      // Utility function to fix Story section overflow
      function fixStoryOverflow() {
        console.log("Fixing Story section overflow...");
        const storySection = document.querySelector(".story");
        const storyContent = storySection?.querySelector(".story-content");

        if (storySection && storyContent) {
          const sections = document.querySelectorAll(".section");
          const storyIndex = Array.from(sections).indexOf(storySection);

          // Force recalculation with extra buffer
          widthCalculator.cache.clear();
          const actualScrollWidth = storyContent.scrollWidth;
          const newWidth = Math.max(actualScrollWidth + 300, window.innerWidth);

          // Update the width directly
          widthCalculator.sectionWidths[storyIndex] = newWidth;
          storySection.style.width = `${newWidth}px`;

          // Recalculate positions
          for (let i = storyIndex + 1; i < sections.length; i++) {
            widthCalculator.sectionPositions[i] =
              widthCalculator.sectionPositions[i - 1] + widthCalculator.sectionWidths[i - 1];
          }

          // Update total width
          widthCalculator.totalWidth =
            widthCalculator.sectionPositions[widthCalculator.sectionPositions.length - 1] +
            widthCalculator.sectionWidths[widthCalculator.sectionWidths.length - 1];

          // Update container
          containerManager.updateContainerWidth(widthCalculator.totalWidth);
          containerManager.updateSectionWidths(widthCalculator.sectionWidths);

          console.log(`Story section width updated to: ${newWidth}px`);
          console.log("New total width:", widthCalculator.totalWidth);

          // Re-position to current section
          navigationController.scrollToSection(navigationController.currentSection, false);
        }
      }

      // Expose testing function globally for debugging
      window.runBasicTests = runBasicTests;
      window.fixStoryOverflow = fixStoryOverflow;
      window.dynamicScrollSystem = {
        widthCalculator,
        containerManager,
        navigationController,
        responsiveHandler,
      };

      // Initialize when DOM is ready
      document.addEventListener("DOMContentLoaded", () => {
        initializeDynamicScrolling();
        // Run tests after initialization
        setTimeout(runBasicTests, 500);
      });

      // Fallback initialization if DOMContentLoaded already fired
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", () => {
          initializeDynamicScrolling();
          setTimeout(runBasicTests, 500);
        });
      } else {
        initializeDynamicScrolling();
        setTimeout(runBasicTests, 500);
      }
    </script>
  </body>
</html>
